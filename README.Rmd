---
title: "The kids are not alright: Declines in mental health among Australia's youngest birth cohorts"
output:
  github_document:
    df_print: kable
bibliography: src/references.bib
csl: src/apa-6th-edition.csl
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      fig.path = "figures/")

library(tidyverse)
library(mgcv)
library(patchwork)

`%notin%` <- Negate(`%in%`)
```

*A study of cohort differences in subjective wellbeing among young people in Australia*  

<br>

Recent deterioration in mental health in Australia, especially among young people, has spurred much speculation around the causes of the decline and what can be done to arrest it [@skinner2022population]. For instance, the proportion of people reporting high or very high levels of psychological distress in Australia has increased year-on-year from 10.8% in 2011-12 to 15.4% in 2020-21 according to the ABS [@abs2022]. This increase was particularly prevalent among younger age groups, with 18-24 year olds reporting the largest increase from 11.8% in 2011-12 to 20.1% in 2020-21. These increases are also mirrored in longitudinal surveys of mental health such as HILDA [@butterworth2020trends], as well as the prevalence of recent mental disorders, which has increased from 13.4% in 2011-12 to 20.4% in 2020-21, including almost two in five people (39.6%) aged 16-24.  

Other OECD countries have observed similar declines in population levels of mental health, including among young people [UK, USA, Netherlands, Japan, see Table 2 in @ormel2022more; hidaka2012depression; @nishi2018trends], but not all [e.g., Canada, @patten2016major]. In many cases the changes can be attributable to the overall growth of the global population and its changing age structure (i.e., _age effects_) [@vos2016global; @ferrari2013burden; @baxter2014challenging], or loss of economic opportunity due to periods of disruption such as the GFC or the COVID-19 global pandemic (i.e., _period effects_) [@glozier2022happened; @butterworth2022lockdown].  

Age effects can influence the population-level trends when mental health changes over the lifespan as part of normal development/aging and the age-structure of the population also changes to include more age-groups with lower mental health. Comparing age groups over the population has revealed a U-shaped pattern in affective wellbeing (similar to mental health) in large cross-sectional surveys, whereby hedonic aspects of wellbeing decline from young age-groups (e.g., 18-20) to middle-age (50-55) before increasing to a peak at 70-75, although there are cultural and national differences [@stone2010snapshot; @steptoe2015subjective]. In Australia, @burns2020age described the cross-sectional differences in the mental health of Australian adults using 17 years of HILDA data (2001-2017). They report only very small differences in mental health (MHi-5 scores) over age-groups, however there was an emerging downward trend for the youngest (18-24) and very oldest adults (75+) in the more recent years (*Their cohort trajectory analysis indicated there is an improvement in mental health as people age before a substantial decline after 75 yo, but little evidence of any cohort-specific effects*).  

Period effects refer to variance over time that is common across all age groups, such as due to the COVID-19 global pandemic that took place in 2020-2021. For example in Australia, lockdowns during COVID-19 significantly reduced the mental health of women with children in 2020 [@butterworth2022lockdown; @schurer2022zero]. However COVID-19 cannot explain the longitudinal trends in mental health observed before 2020 in Australia. @butterworth2020trends found an increase in psychological distress (K10 scores) from 4.8% to 7.4% between 2007 to 2017, but only among 18-34 and 35-64 age groups in a representative longitudinal sample. The GFC in 2008 may represent a period effect responsible for such a decline, as it appears restricted to working age people who may be more adversely impacted by wide-spread changes in economic conditions. 

Because mental health changes over time and with age for a variety of reasons (broadly distinguished so far as age- or period- effects), locating the source of any varying trend is critical before targeted interventions can be effective. The evidence reviewed so far indicates trends in mental health may exist yet comparisons between cross-sectional and longitudinal studies reveals inconsistencies [e.g., @butterworth2020trends]. Since @fienberg1978identification, social scientists, demographers and epidemiologists have recognized that a critical concern is whether the changes observed are due to age-, period-, or _cohort_ effects [e.g., @bell2020age; @fukuda2013happiness; @burns2020age; @kratz2021age]. Cohort effects refer to variance over time that is specific to individuals born in or around certain years (i.e., generational differences between "millenials" and "boomers"). Because age effects are a linear combination of period and cohort effects (A = P - C), there is no technical way to solve the dependency and identify the unique effect of each in a linear model [@fienberg1978identification; @luo2013assessing; @holford1983estimation]. Adding covariates to the linear APC model changes the model but not the identification problem. The only way to make it go away is by fiat; that is by conceding some constraint whose appropriateness cannot be tested [@fienberg2013cohort; @fienberg1985specification; @mason1985cohort], or by focusing on nonlinear effects and possibly some interactions [@bell2020age].  

We set out to distinguish whether the widely-observed decline in mental health in Australia is due to variation with age, or common effects of the recent period, or differences between birth cohorts. To identify any recent period effect, we explicitly modelled mental health (MHi-5 scores) for each age-group as a nonlinear smooth function of time (year). To identify cohort effects from age effects, we explicitly modeled mental health for each birthcohort as a nonlinear smooth function of age. Comparisons between smooths allowed us to determine where differences between age-groups or cohorts occurred.   



```{r}
# abs_distress <- read_rds("data/abs_distress_2012-2018.rds")
# 
# abs_distress %>%
#   filter(Demographic == "Persons", Distress == "Very high or high") %>%
#   select(-Error) %>%
#   spread(Year, Percent)
```


```{r import_data}
hilda.data <- read_rds("data/preprocessed.RDS") %>%
  select(xwaveid, year, sex, age, ghmh, pdk10s, topup) %>%
  filter(!is.na(ghmh)) %>%
  mutate(
    age_group = case_when(
      age <= 14 ~ "0-14",  # there is n = 1 fourteen year old
      age <= 24 ~ "15-24", 
      age <= 34 ~ "25-34",
      age <= 44 ~ "35-44",
      age <= 54 ~ "45-54",
      age <= 65 ~ "55-64",
      age <= 75 ~ "65-74",
      age <= 85 ~ "75-84",
      TRUE      ~ "85+"),
    birthyear = year - age,
    cohort = case_when(
      birthyear %in% 1900:1929 ~ "1920s",
      birthyear %in% 1930:1939 ~ "1930s", 
      birthyear %in% 1940:1949 ~ "1940s",
      birthyear %in% 1950:1959 ~ "1950s",
      birthyear %in% 1960:1969 ~ "1960s",
      birthyear %in% 1970:1979 ~ "1970s",
      birthyear %in% 1980:1989 ~ "1980s",
      birthyear %in% 1990:1999 ~ "1990s",
      birthyear %in% 2000:2009 ~ "2000s", 
      birthyear %in% 2010:2020 ~ "2010s", 
      TRUE ~ "problem"
    )) %>%
  mutate(xwaveid = factor(xwaveid),
         ocohort = ordered(cohort),
         fcohort = factor(cohort))
```

<br><br>

## Results  

This is the main plot showing birth cohort differences in MHi-5 scores. Mental health (MHi-5) is worse for younger age-groups and even worse again for more recent younger age groups (left panel) - consistent with a cohort effect. The right panel shows mental health is worse for younger generations, particularly *Millenials* born in the 1990s who have a lower score at the same age as older generations. Uncertainty is not quantified (e.g., confidence intervals) due to the dependence that exists within birth cohorts from repeated observations of the same individuals.  


##### Figure 1

```{r figure_1, fig.dim=c(8,7)}
plot.data <- hilda.data %>%
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  filter(age_group %notin% c("0-14", "75-84", "85+"))

ylims = c(65, 80)

p1 <- ggplot(plot.data, aes(x = year, y = ghmh)) +
  geom_smooth(aes(group = age_group, color = age_group), 
              method = "gam", formula = y ~ s(x, bs = "cs"), se=F) +
  labs(
    subtitle = paste("Smoothed MHi-5 scores (0-100) by age group"), 
    y = "", x = "Survey year") +
  coord_cartesian(ylim = ylims) +
  scale_color_manual(values = rev(blues9)) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        legend.title = element_text(size = 10),
        legend.position = c(0.2, 0.2),
        axis.title.x = element_text(size = 10))


p2 <- ggplot(plot.data, aes(x = age, y = ghmh)) +
  geom_smooth(aes(group = 1), 
              method = "gam", formula = y ~ s(x, bs = "cs"), 
              se=F, color = "black", size = .5, linetype = "dashed") +
  geom_smooth(aes(group = cohort, color = cohort), 
              method = "gam", formula = y ~ s(x, bs = "cs"), 
              se=F, alpha = 0.2) +
  labs(
    subtitle = "Smoothed MHi-5 scores (0-100) by cohort", 
    y = "", x = "\n Age (years)") +
  coord_cartesian(ylim = ylims) +
  scale_color_manual(values = blues9[3:9]) +
  # scale_color_manual(values = grey.colors(6, rev = T)) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        legend.title = element_text(size = 10),
        legend.position = c(0.9, 0.2),
        axis.title.x = element_text(size = 10))

p1 + p2
```

<br>

#### Cohort comparisons  

We need to compare the smooth trends of each cohort to the next generation (e.g., 1990s vs 1980s) so as to infer whether the trend is increasing or decreasing _relative_ to the next. We cannot compare trends from birth cohorts more than two decades apart since there are no overlapping age groups observed, so we will restrict ourselves to the five pairwise comparisons between each cohort and the next.  

We will use the generalized additive modelling (GAM) method provided by Wood et al [@wood2004stable; @wood2006low; @wood2011fast; @wood2016smoothing].  

The smooth trends are expressed as spline functions and estimated by quadratically penalized likelihood maximization for automatic smoothness selection. 

$$
\begin{align}

y_{it} &= \alpha(cohort_{[k]}) + f_{[k]} (age_{it}) + \epsilon_{it} \\
\epsilon &\sim N(0, \Delta \sigma^2)

\end{align}
$$




Where $\alpha_{[k]}$ is the mean subjective wellbeing score for each $k = 1...K$ cohort, and $f_{[k]}$ are smooth functions for the trend in MHi-5 scores over age for each cohort. To account for the person-level dependency when survey participants are measured more than once, we included a first-order autoregressive model AR(1) for the residuals based on the unique crosswave ID for each person $i = 1...I$.  

The smooth estimates, along with 95% credible/confidence intervals (which include the uncertainty about the overall mean as well as the centred smooth itself), are shown below. In each row the older cohort is shown on the left as the reference smooth, and the estimated difference between the reference and the younger cohort is shown on the right as the difference smooth.  

```{r gamm_fits, eval=F}
difference_gam <- function(.dat, cohorts) {
  
  cohorts <- sort(cohorts)
  
  .dat %>%
    filter(cohort %in% cohorts) %>%
    droplevels() %>%
    gamm(
      formula = ghmh ~ cohort + s(age) + s(age, by = ocohort),
      correlation = corAR1(form=~1|xwaveid), # AR1 errors within xwaveid
      method = "REML",
      data = .
    ) -> fit
  
  plot_obj <- plot(fit$gam, seWithMean = T)
  # seWithMean = T for confidence intervals that include the uncertainty about
  # the overall mean as well as the centred smooth itself. This results in inter-
  # vals with close to nominal (frequentist) coverage probabilities (Marra & 
  # Woods, 2012).
  
  bind_rows(
    
    as.data.frame(plot_obj[[1]][c("x", "se", "fit")]) %>%
      mutate(cohort = paste(cohorts[1], "smooth")),
    
    as.data.frame(plot_obj[[2]][c("x", "se", "fit")]) %>%
      mutate(cohort = paste(cohorts[2], "difference"))
  )
  
}

difference_gam(hilda.data, c("1990s", "1980s")) %>%
  write_rds("results/gam_90v80s.rds")

difference_gam(hilda.data, c("1980s", "1970s")) %>%
  write_rds("results/gam_80v70s.rds")

difference_gam(hilda.data, c("1970s", "1960s")) %>%
  write_rds("results/gam_70v60s.rds")

difference_gam(hilda.data, c("1960s", "1950s")) %>%
  write_rds("results/gam_60v50s.rds")

difference_gam(hilda.data, c("1950s", "1940s")) %>%
  write_rds("results/gam_50v40s.rds")
```

```{r figure_2, fig.dim=c(7, 15)}
difference_plot <- function(.dat) {
  ggplot(.dat, aes(x = x, y = fit)) +
    geom_hline(aes(yintercept=0), linetype = "dotted") + 
    geom_ribbon(aes(ymin = fit - se, ymax = fit + se, y = NULL),
                fill = "grey80") +
    geom_line() +
    facet_wrap(~cohort) +
    labs(x = "Age", y = "centred estimate") +
    theme_minimal()
}

p1 <- difference_plot(read_rds("results/gam_90v80s.rds"))

p2 <- difference_plot(read_rds("results/gam_80v70s.rds"))

p3 <- difference_plot(read_rds("results/gam_70v60s.rds"))

p4 <- difference_plot(read_rds("results/gam_60v50s.rds"))

p5 <- difference_plot(read_rds("results/gam_50v40s.rds"))

p1 / p2 / p3 / p4 / p5
```

<br>

The difference smooths reveal where the younger cohort is substantially different from the older reference cohort where the confidence bounds exclude zero (dotted line) [@marra2012coverage; @wood2013p]. Inspection of the _1990s difference_ panel reveals the youngest cohort's wellbeing trajectory is significantly declining with age relative to the 1980s cohort. After the age of 25, a person born in the 1990s is expected to have lower subjective wellbeing than an equivalently aged person born earlier (e.g., 1980s). The other cohorts also have declining trajectories relative to their reference (older) cohort, albeit not as substantial a decline and not as reliably beyond zero as the 1990s cohort. The exception is the 1950s cohort which has a (non-significantly) increasing trajectory relative to the reference cohort, consistent with the prevailing view in popular and social media that the "Baby Boomers" have had a great time at the expense of the other generations.  





<br><br>

## Appendix  

The difference between male and female MHi-5 trajectories is mostly in the intercept (overall mean level). Men and women have similar trajectory differences between cohorts.   

##### Figure A1. Interaction between sex and cohort
```{r figure_A1, fig.dim=c(8,7)}
reds <- RColorBrewer::brewer.pal(6, "Reds")

hilda.data %>%
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  ggplot(aes(x = age, y = ghmh)) +
    geom_smooth(aes(group = sex),
                method = "gam", formula = y ~ s(x, bs = "cs"),
                se=F, color = "black", size = .5, linetype = "dashed") +
    geom_smooth(aes(group = interaction(cohort,sex), 
                    color = interaction(cohort,sex)), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F) +
    labs(
      subtitle = "Smoothed MHi-5 scores (0-100) between 2001-2020", 
      y = "", x = "\n Age (years)") +
    scale_color_manual(values = c(reds, blues9[3:9])) +
    guides() +
    theme_minimal() +
    theme(plot.title = element_text(face = "bold"),
          legend.title = element_text(size = 10),
          legend.position = c(0.9, 0.2),
          axis.title.x = element_text(size = 12))
```

<br>

Excluding the Wave 11 top-up sample does not appear to greatly impact the cohort trajectories.  

##### Figure A2. Excluding top-up sample
```{r figure_A2, fig.dim=c(8,7)}
hilda.data %>%
  filter(!topup) %>%
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  ggplot(aes(x = age, y = ghmh)) +
    geom_smooth(aes(group = 1), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F, color = "black", size = .5, linetype = "dashed") +
    geom_smooth(aes(group = cohort, color = cohort), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F, alpha = 0.2) +
    labs(
      subtitle = "Smoothed MHi-5 scores (0-100) between 2001-2020", 
      y = "", x = "\n Age (years)") +
    scale_color_manual(values = grey.colors(6, rev = T)) +
    theme_minimal() +
    theme(plot.title = element_text(face = "bold"),
          legend.title = element_text(size = 10),
          legend.position = c(0.9, 0.2),
          axis.title.x = element_text(size = 12))
```

<br>

K10 scores (psychological distress) were collected in alternate years from 2007 to 2019. The corresponding trajectories for each cohort are shown below. Psychological distress was higher for younger cohorts than older cohorts at the same age. 

##### Figure A3. K10 scores (psychological distress)  
```{r figure_A3, warning=F, fig.dim=c(8,7)}
hilda.data %>%
  filter(!topup) %>%
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  ggplot(aes(x = age, y = pdk10s)) +
    geom_smooth(aes(group = 1), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F, color = "black", size = .5, linetype = "dashed") +
    geom_smooth(aes(group = cohort, color = cohort), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F, alpha = 0.2) +
    labs(
      subtitle = "Smoothed K10 scores (10-50) between 2007-2019", 
      y = "", x = "\n Age (years)") +
    scale_color_manual(values = grey.colors(6, rev = T)) +
    theme_minimal() +
    theme(plot.title = element_text(face = "bold"),
          legend.title = element_text(size = 10),
          legend.position = c(0.9, 0.82),
          axis.title.x = element_text(size = 12))
```

<br>

<br><br>

## References  













