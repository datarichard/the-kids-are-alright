---
title: "Differential trends in mental health in Australia"
author: "F Botha^1,4^, RW Morris^1-3^, P Butterworth^4,5^, N Glozier^1,2^"
output:
   word_document:
    reference_docx: src/Rmarkdown-for-Word-styles.docx
bibliography: src/references.bib
csl: src/apa-6th-edition.csl
editor_options:
  chunk_output_type: console
always_allow_html: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      fig.path = "figures/",
                      dpi=300,
                      ft.align="left")

library(tidyverse)
library(mgcv)
library(patchwork)
library(gtsummary)
library(flextable)

`%notin%` <- Negate(`%in%`)

# Use the correct age variable hhiage
# Explain why there is gap in 65-74 in Figure 1 left panel
# Explain the problem of interpreting a main effect in the presence of a signi-
# ficant interaction. Start with a test of the (centered) mean difference and 
# then move to the slope (i.e., interaction)
# Add a sensitivity analysis excluding the first observation
# Remove mention of affective wellbeing
# Add a figure of MHI-5 < 52/64
```

\ 

1.  ARC Centre of Excellence for Children and Families over the Life Course
2.  Central Clinical School, Faculty of Medicine and Health, University of Sydney, NSW, Australia
3.  School of Psychology, Faculty of Science, University of Sydney, NSW, Australia
4.  Melbourne Institute: Applied Economic & Social Research, The University of Melbourne, VIC, Australia
5.  National Centre for Epidemiology and Population Health, The Australian National University, ACT, Australia

<br><br>

\ 

\ 

\ 

Acknowledgement: This research was supported by the Australian Government through the Australian Research Council's Centre of Excellence for Children and Families over the Life Course (Project ID CE200100025)

<br><br>

<br><br>

<br><br>

<br><br>

## Abstract

Given the observed deterioration in mental health among Australians over the past decade, this study investigates to what extent this differs in people born in different decades –i.e. possible cohort differences in mental health among young people in Australia. Using 20 years of data from the Household, Income and Labour Dynamics in Australia (HILDA) Survey, we find strong evidence that cohort effects are driving the declines in mental health. Deteriorating mental health is particularly pronounced among the 1990s cohort, and seen to a lessor extent among the 1980s cohort. There is little evidence that mental health is worsening with age for people born prior to the 1980s. The findings from this study highlight that Millenials are driving the deterioration in population-level mental health. Understanding the changes in society that have differentially affected younger people may help ameliorate this trend, and prevent it continuing for emerging cohorts.

<br><br>

<br><br>

<br><br>

<br><br>

<br><br>

<br><br>

<br><br>

<br><br>

<br><br>

In many countries there has been an increase in the prevalence of mental ill health, even prior to COVID, alongside increasing use of both psychotropics and therapeutic services [@peach2022mental]. For instance, the proportion of Australians reporting high or very high levels of psychological distress has increased year-on-year from 10.8% in 2011-12 to 15.4% in 2020-21 according to the ABS [@abs2022]. This rise in psychological distress was particularly prevalent among younger age groups, with 18-24 year olds reporting the largest increase from 11.8% in 2011-12 to 20.1% in 2020-21. These increases are also mirrored in large, longitudinal panel surveys such as the Household, Income and Labour Dynamics in Australia (HILDA) Survey [@butterworth2020trends], as well as the prevalence of recent mental disorders in focused population-based mental health surveys, where an increase from 13.4% in 2011-12 to 20.4% in 2020-21, including almost two in five people (39.6%) aged 16-24 has just been reported [@abs2022].

Other OECD countries have observed similar declines in population levels of mental health, including among young people in the UK, USA, Netherlands, and Japan [@twenge2019age; @ormel2022more; @hidaka2012depression; @nishi2018trends], though not all [e.g., Canada, @patten2016major]. In many cases these changes can be attributed to changing age structures as the national population grows (i.e., *age effects*) [@vos2016global; @ferrari2013burden; @baxter2014challenging], or due to periods of disruption such as the global financial crisis (GFC) or the COVID-19 pandemic and the loss of economic opportunity these entail (i.e., *period effects*) [@glozier2022happened; @butterworth2022lockdown].

Age effects can influence the population-level trends when the age-structure of the population changes to include more age-groups with poorer mental health. Comparing age groups over the population has revealed a U-shaped pattern in affective wellbeing (similar to mental health) in large cross-sectional surveys, whereby hedonic aspects of wellbeing decline from young age-groups (e.g., 18-20) to middle-age (50-55) before increasing to a peak at 70-75, although there are cultural and national differences [@stone2010snapshot; @steptoe2015subjective]. In Australia, @burns2020age described the cross-sectional differences in the mental health of Australian adults using 17 years of HILDA data (2001-2017). Using the mental health inventory (MHI-5), they report only very small differences in mental health over age-groups, however there was an emerging downward trend for the youngest (18-24) and very oldest adults (75+) in the more recent years. A cohort trajectory analysis indicated there is an improvement in mental health as people age before a substantial decline after 75 years of age, but little evidence of any cohort-specific effects.

Period effects refer to variance over time that is common across all age groups, such as due to the COVID-19 pandemic that started in 2020. For example in Australia, lockdowns during COVID-19 significantly reduced the mental health of women with children in 2020 [@butterworth2022lockdown; @schurer2022zero]. However, the pandemic cannot explain the deteriorating longitudinal trends in mental health observed before 2020 in Australia. Also using HILDA data, @butterworth2020trends found an increase in psychological distress (K10 scores) from 4.8% to 7.4% between 2007 to 2017, but only among 18-34 and 35-64 age groups in a representative longitudinal sample. The GFC in 2008 may represent a period effect responsible for such a decline, as it appears restricted to working-aged people who may be more adversely impacted by wide-spread changes in economic conditions.

Because mental health changes over time and with age for various reasons (broadly distinguished so far as age- or period- effects), accurately locating the source of any such varying trend is critical before targeted interventions can be effective. The evidence reviewed so far indicates trends in mental health may exist, yet comparisons between cross-sectional and longitudinal studies reveal inconsistencies [e.g., @butterworth2020trends].

Since @fienberg1978identification, researchers have recognised that a critical concern is whether the changes observed are due to age-, period-, or *cohort* effects [e.g., @bell2020age; @fukuda2013happiness; @burns2020age; @kratz2021age]. Cohort effects refer to variance over time that is specific to individuals born in or around certain years (i.e., generational differences between "millenials" and "baby boomers"). Because age effects (A) are a linear combination of period (P) and cohort (C) effects (A = P - C), there is no technical way to solve the dependency and identify the unique effect of each in a linear model [@fienberg1978identification; @luo2013assessing; @holford1983estimation]. Adding covariates to the linear APC model changes the model but not the identification problem. The only way to solve this issue is by fiat; that is by conceding some constraint whose appropriateness cannot be tested [@fienberg2013cohort; @fienberg1985specification; @mason1985cohort], or by focusing on nonlinear effects and possibly some interactions [@bell2020age].

In this paper, we aim to distinguish whether the widely-observed decline in mental health in Australia is due to variation with age, or common effects of the recent period, or differences between birth cohorts. To identify any recent period effect, we explicitly model mental health (MHI-5 scores) for each age-group as a nonlinear smooth function of time. To identify cohort effects from age effects, we explicitly model mental health for each birth cohort as a nonlinear smooth function of age. Comparisons between smooths allow us to determine where any differences between age-groups or cohorts occurred.

## Methods  

```{r import_data}
hilda.data <- read_rds("data/preprocessed.RDS") %>% 
  select(xwaveid, year, sex, age, ghmh, pdk10s, topup) %>%
  filter(!is.na(ghmh)) %>%
  mutate(
    age_group = case_when(
      age <= 14 ~ "0-14",  # there is n = 1 fourteen year old
      age <= 24 ~ "15-24", 
      age <= 34 ~ "25-34",
      age <= 44 ~ "35-44",
      age <= 54 ~ "45-54",
      age <= 65 ~ "55-64",
      age <= 75 ~ "65-74",
      age <= 85 ~ "75-84",
      TRUE      ~ "85+"),
    birthyear = year - age,
    cohort = case_when(
      birthyear %in% 1900:1929 ~ "1920s",
      birthyear %in% 1930:1939 ~ "1930s", 
      birthyear %in% 1940:1949 ~ "1940s",
      birthyear %in% 1950:1959 ~ "1950s",
      birthyear %in% 1960:1969 ~ "1960s",
      birthyear %in% 1970:1979 ~ "1970s",
      birthyear %in% 1980:1989 ~ "1980s",
      birthyear %in% 1990:1999 ~ "1990s",
      birthyear %in% 2000:2009 ~ "2000s", 
      birthyear %in% 2010:2020 ~ "2010s", 
      TRUE ~ "problem"
    )) %>%
  mutate(xwaveid = factor(xwaveid),
         ocohort = ordered(cohort),
         fcohort = factor(cohort))
```

#### Sample selection  

The sample included all persons over the age of 14 in the household who completed the SCQ (Self Completion Questionnaire) in each year. The birth cohort of each person were defined by the decade of birth year (1940s, 1950s, 1960s, 1970s, 1980s, 1990s). Thus persons can only contribute to a single birth cohort, but can be observed multiple times across survey years/ages. Persons were excluded if they were born prior to 1940 or after 1999, as after stratification by age they represented cohorts with sample sizes smaller than desirable for estimation of penalised nonlinear GAMs. An MHi-5 score was estimated for each person/year for which there were valid responses on greater than or equal to half the items, where missing data was replaced with the average score on the valid items (imputation was performed by  HILDA, as per the planned survey design to minimise attrition and sampling error). Thus missing scores were excluded on a year-by-person basis. Demographic details of the sample are provided in the Results in Table 1 below.   


```
please add any further details about sample selection here  
```

<br><br>

#### Measures  

The MHi-5 is a well-validated subset of 5 items from the mental health component of SF-36 dealing with positive and negative aspects of mental health [@batterham2018assessing; @cuijpers2009screening; @ware2000sf; @ware1992mos]:  

1. "Been a nervous person"
2. "Felt so down in the dumps nothing could cheer you up"
3. "Felt calm and peaceful"
4. "Felt down"
5. "Been a happy person"  

Items were scored to ensure higher scores represented better mental health.  

```
if appropriate please add some blurb about how good the MHi-5 is, or how widely used/useful it is in Australia
```

<br><br>

#### Analysis  

We estimate penalized smooth trends for each cohort using restricted maximum likelihood (REML) in a generalized additive mixed modelling (GAMM) approach, described by Wood et al [@wood2004stable; @wood2006low; @wood2011fast; @wood2016smoothing]. This is an analogue to a linear multilevel model with varying intercepts and slopes among the cohorts, but here the slopes are allowed to "wiggle". The model includes a global smoothing term for the effect of age as well as cohort-specific terms, so each cohort is allowed to have it's own functional response but the penalty ensures that functions too far from average are penalized.

Each smoother $f_k$ is represented by a sum of $K$ simpler, fixed basis functions. The basis functions (splines) were estimated by quadratically penalized likelihood maximization for automatic smoothness selection, with a starting value of $K=9$.

$\ \ \ \ y_{it} = \alpha_i + \beta_{k}(cohort_i) + f(age_{it}) + f_{[k]} (age_{it}) + \zeta_{i} + \epsilon_{it}$

$\ \ \ \ \epsilon_i \sim N(0, \phi \sigma^2)$

Where $y_{it}$ is the person-centered MHI-5 score, $\alpha_i$ is the person-level mean MHI-5 score, $\beta_{[k]}$ is the mean MHI-5 score for each $k = 1...K$ birth cohort, and $f_{[k]}$ are smooth functions for the trend in MHI-5 scores over age for each cohort. To account for the person-level dependency when survey participants are measured more than once, we included a first-order autoregressive AR(1) term $\phi$ for the residuals based on the unique crosswave ID for each person $i = 1...I$, which is equivalent to including the person-level random intercept $\zeta_i$ nested within cohort.

Wald tests were used for pairwise comparisons of the average difference in MHI-5 scores between each cohort and the next generation (e.g., 1990s vs 1980s). We did not compare cohorts more than a decade apart since there are few or no overlapping age groups observed, so we restricted ourselves to the five ($K-1$) pairwise comparisons between each cohort and the next oldest cohort (i.e., the *reference* cohort). Even so the average difference in mental health between cohorts is confounded with the effect of age. To control for differences in age between cohorts, it is necessary to compare the estimated smooth trends of each cohort over the same age range. Thus we estimated the $K-1$ pairwise differences between each smooth trend and it's reference so as to infer whether the difference is increasing or decreasing (i.e., the trend *relative* to the reference). The smooth trends in this comparison were centered for identifiability reasons, and so any change in trend is centered around zero [@marra2012coverage; @wood2013p].  

```{r gamm_fits, eval=F}
difference_gam <- function(.dat, cohorts) {
  
  cohorts <- sort(cohorts)
  
  .dat %>%
    filter(cohort %in% cohorts) %>%
    droplevels() %>%
    gamm(
      formula = ghmh ~ cohort + s(age) + s(age, by = ocohort),
      correlation = corAR1(form=~1|xwaveid), # AR(1) errors within xwaveid
      method = "REML",
      data = .
    ) 
}

difference_gamz <- function(.dat, cohorts) {
  
  cohorts <- sort(cohorts)
  
  .dat %>%
    filter(cohort %in% cohorts) %>%
    droplevels() %>%
    group_by(xwaveid) %>%
    mutate(
      ghmh.m = mean(ghmh),
      ghmh.c = c(scale(ghmh, center = T, scale = F))
    ) %>%
    ungroup() %>%
    gamm(
      formula = ghmh.c ~ ghmh.m + cohort + s(age) + s(age, by = ocohort),
      correlation = corARMA(form=~1|xwaveid, p = 3, q = 1), # AR(p) & MA(q)
      method = "REML",
      data = .
    ) 
}



difference_gamz(hilda.data, c("1990s", "1980s")) %>%
  write_rds("results/gam_90v80z.rds")

difference_gamz(hilda.data, c("1980s", "1970s")) %>%
  write_rds("results/gam_80v70z.rds")

difference_gamz(hilda.data, c("1970s", "1960s")) %>%
  write_rds("results/gam_70v60z.rds")

difference_gamz(hilda.data, c("1960s", "1950s")) %>%
  write_rds("results/gam_60v50z.rds")

difference_gamz(hilda.data, c("1950s", "1940s")) %>%
  write_rds("results/gam_50v40z.rds")
```

<br><br>

## Results

The demographics of each cohort are shown in Table 1 below. Only the most recent observation from each person is included.

##### Table 1. Demographics stratified by birth cohort  

```{r table_1, eval=T}
demogs <- read_rds("data/preprocessed.RDS") %>%
  select(xwaveid, year, sex, employment, student, edu, chronic, relationship,
         losat, losatyh, pdk10rc) %>%
  mutate(Female = sex == "Female",
         k10 = pdk10rc == 4,
         Employment = str_to_sentence(employment),
         Relationship = na_if(relationship, "(missing)"),
         Relationship = str_to_title(Relationship)
         )

hilda.data %>% 
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  group_by(xwaveid) %>%
  mutate(lastobs = year == max(year)) %>%
  ungroup() %>%
  filter(lastobs) %>%
  left_join(demogs, by = c("xwaveid", "year")) %>%
  droplevels() %>%
  select(
    cohort,
    Female,
    `Age (years)` = age,
    `MHI-5 score` = ghmh,
    `Very high distress (K10 > 29)` = k10,
    Employment,
    # `Current student` = student,
    `Highest Ed.` = edu,
    `Chronic illness` = chronic,
    Relationship 
    # `Life-satisfaction` = losat,
    # `Health` = losatyh
  ) %>%
  tbl_summary(by = cohort,
              missing = "no") %>%
  as_flex_table() %>%     # convert to flex table
  fontsize(size = 9, part = "all") %>%
  width(j = 1, width = 1.5) %>%
  width(j = 2:7, width = .85) 
```

<br>

Younger cohorts are more likely to have lower mental health (MHI-5 score), higher distress, more likely to be single and unemployed, and less likely to be chronically ill or disabled.

The complete range of ages is shown in the table below, which includes every observation of every person in every year available.

##### Table 2. Age distribution by cohort  

```{r table_2}
hilda.data %>% 
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  group_by(cohort) %>%
  summarise(
    youngest = min(age),
    median = median(age),
    oldest = max(age),
    observations = prettyNum(n(), big.mark=",")
  ) %>%
  flextable() %>%
  fontsize(size = 9, part = "all") %>%
  autofit()
```

<br>

```{r gam_list}
gam.list <- list(
  `90v80s` = read_rds("results/gam_90v80_zp.rds") %>% .$gam,
  `80v70s` = read_rds("results/gam_80v70_zp.rds") %>% .$gam,
  `70v60s` = read_rds("results/gam_70v60_zp.rds") %>% .$gam,
  `60v50s` = read_rds("results/gam_60v50_zp.rds") %>% .$gam,
  `50v40s` = read_rds("results/gam_50v40_zp.rds") %>% .$gam
)
```

Figure 1 shows changes in mental health scores (MHI-5) over time by age (left panel), as well as birth cohort (right panel), where the dotted line represents the average age effect ignoring cohort. Mental health is worse for younger age-groups and even worse again for more recent younger age groups (left panel), that is, consistent with a cohort effect. The right panel shows mental health is worse for younger generations, where deviations from the dotted line indicate the presence of a cohort effect. In particular *Millenials* born in the 1990s have a lower score at the same age as older generations, where at age 30 the average MHI-5 score (on the 0-100 scale) of those born in the 1990s is about 67, compared to about 72.5 and 74 for people born in the 1908s and 1970s respectively. Uncertainty is not quantified (e.g., confidence intervals) in these plots, but statistical comparison of the average difference between each cohort and the next oldest cohort (reference cohort) is presented below in Table 3.  

##### Figure 1. Age and cohort effects on mental health

```{r figure_1, fig.dim=c(7,5)}
plot.data <- hilda.data %>%
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  filter(age_group %notin% c("0-14", "75-84", "85+"))

ylims = c(65, 80)

p1 <- ggplot(plot.data, aes(x = year, y = ghmh)) +
  geom_smooth(aes(group = age_group, color = age_group), 
              method = "gam", formula = y ~ s(x, bs = "cs"), se=F) +
  labs(
    subtitle = paste("Smoothed MHI-5 scores 0-100 (by age group)"), 
    y = "", x = "Survey year") +
  coord_cartesian(ylim = ylims) +
  scale_color_manual(values = rev(blues9)) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        legend.title = element_text(size = 10),
        legend.position = c(0.2, 0.25),
        axis.title.x = element_text(size = 10))


p2 <- ggplot(plot.data, aes(x = age, y = ghmh)) +
  geom_smooth(aes(group = 1), 
              method = "gam", formula = y ~ s(x, bs = "cs"), 
              se=F, color = "black", size = .5, linetype = "dashed") +
  geom_smooth(aes(group = cohort, color = cohort), 
              method = "gam", formula = y ~ s(x, bs = "cs"), 
              se=F, alpha = 0.2) +
  labs(
    subtitle = "Smoothed MHI-5 scores 0-100 (by cohort)", 
    y = "", x = "\n Age (years)") +
  coord_cartesian(ylim = ylims) +
  scale_color_manual(values = blues9[3:9]) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        legend.title = element_text(size = 10),
        legend.position = c(0.85, 0.25),
        axis.title.x = element_text(size = 10))

p1 + p2
```

<br><br>

##### Table 3. Average pairwise difference in mental health between cohorts  

```{r mean_difference_table}
hilda.data %>% 
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  group_by(cohort, xwaveid) %>%
  summarise(
    mhi5 = mean(ghmh, na.rm=T),
    .groups = "drop") %>%
  aov(mhi5 ~ cohort, .) %>%
  TukeyHSD(.) %>%
  broom::tidy() %>%
  select(contrast:adj.p.value, -null.value) %>%
  filter(
    contrast %in% 
      c("1950s-1940s", "1960s-1950s", "1970s-1960s", "1980s-1970s", "1990s-1980s")) %>%
  mutate(across(where(is.double), ~round(., 3))) %>%
  flextable() %>%
  fontsize(size = 9, part = "all") %>%
  autofit()
```

<br>

Significant pairwise differences between each cohort and the reference cohort occur (*ps* < .05), except for the 1950s vs 1940s comparison (*p* = .127). These results represent mean differences in MHI-5 scores of each cohort (after accounting for variation in the trends over age within each cohort). However the comparisons necessarily confound the effect of age and cohort, and to control for age we present comparisons of the estimated smooth trends over the same age ranges below.  



Figure 2 shows the smooth GAM estimates, along with 95% credible/confidence intervals (which include the uncertainty about the overall mean as well as the centred smooth itself). In each row the older cohort is shown in the left column as the reference smooth, and the estimated difference between the reference and the younger cohort is shown in the right column as the difference smooth. 

##### Figure 2. Centered estimates of cohort trajectories (left) and their differences (right)

```{r figure_2_prep, include=F}
plot.data <- map2(.x = gam.list, .y = names(gam.list), .f = ~{
  
  plot_obj <- plot(.x, seWithMean = T)
  # seWithMean = T for confidence intervals that include the uncertainty about
  # the overall mean as well as the centred smooth itself. This results in inter-
  # vals with close to nominal (frequentist) coverage probabilities (Marra & 
  # Woods, 2012).
  
  bind_rows(
    
    as.data.frame(plot_obj[[1]][c("x", "se", "fit")]) %>%
      mutate(cohort = paste0("19", substring(.y, 4, 6), " smooth")),
    
    as.data.frame(plot_obj[[2]][c("x", "se", "fit")]) %>%
      mutate(cohort = paste0("19", substring(.y, 1, 2), " difference"))
  )
  
}) 
```

```{r figure_2, fig.dim=c(4, 8), out.height="50%", out.width="50%"}
difference_plot <- function(.df) {
  ggplot(.df, aes(x = x, y = fit)) +
    geom_hline(aes(yintercept=0), size = 0.1) + 
    geom_ribbon(aes(ymin = fit - se, ymax = fit + se, y = NULL),
                fill = "grey80") +
    geom_line() +
    facet_wrap(~cohort) +
    labs(x = "Age (years)", y = "MHI-5 units") +
    theme_minimal(base_size = 9) +
    theme(panel.grid = element_blank(),
          axis.title = element_text(size = 7))
}

p1 <- difference_plot(plot.data[[1]])
p2 <- difference_plot(plot.data[[2]])
p3 <- difference_plot(plot.data[[3]])
p4 <- difference_plot(plot.data[[4]])
p5 <- difference_plot(plot.data[[5]])

p1 / p2 / p3 / p4 / p5
```

<br>

The trend in the centered difference smooths (right panels) reveals whether the _change_ in MHI-5 scores of the younger cohort is significantly different from the older reference cohort (left panels) over the same age range, i.e., a cohort effect. For example a significant negative trend in the right panel, as indicated by 95% confidence/credible intervals which exclude zero (horizonal line) in opposite directions at each endpoint, demonstrates MHI-5 scores are declining in the younger cohort at a faster rate than the reference cohort. However a negative trend in the right panel does not by itself indicate whether average MHI-5 scores are deteriorating in that cohort. Inspection of the reference cohort in the left panel is necessary to determine whether the decline represents a true deterioration in mental health. For example, the 1990s difference panel reveals the youngest cohort's mental health trajectory is significantly declining with age relative to the 1980s cohort, and the 1980s smooth (reference in the right panel) is also significantly deteriorating relative to its own mean baseline. Together this represents evidence that MHI-5 scores in the 1990s cohort are declining faster than the deteriorating mental health of the 1980s cohort. Compare to the 1960s difference smooth in the right panel, where there is also a significant negative trend however the trend in the 1950s reference smooth (left panel) is positive, so the negative difference in the right panel is not due to changes in the 1960s cohort but rather improvements in the 1950s cohort. In general, no cohort shows a steeper decline relative to its reference than the 1990s cohort, and when cohorts older than 1990s tend to decline relative to their older reference cohort (right panels) it is not due to a deterioration relative to their own mean baseline (left panels).   

The statistical significance of the smooth differences indicates where the trend in differences between cohorts are non-zero (i.e., positive or negative). As such they reveal the presence of cohort-effects adjusted for age. P-values based on Nychka (1988) are shown below:  

##### Table 4. Approximate significance of smooth differences  

```{r difference_table}
map_dfr(gam.list, .f = broom::tidy, .id = "model") %>%
  left_join(
    map_dfr(gam.list, .f = ~mgcv:::k.check(.) %>% 
              as_tibble(rownames = "term"), 
            .id = "model"),
    by = c("model", "term", "edf")
  ) %>%
  select(term, `k-index`, edf, F.value = statistic, p.value) %>%
  filter(str_detect(term, "ocohort")) %>%
  mutate(term = str_remove(term, "s\\(age\\):ocohort"),
         term = paste(term, "difference")) %>%
  mutate(across(`k-index`:F.value, ~round(., 2))) %>%
  mutate(p.value = round(p.value, 3)) %>%
  flextable() %>%
  fontsize(size = 9, part = "all") %>%
  autofit()
```

<br>

The p-values indicate that cohort effects exist between each of the younger cohorts and the next oldest cohort, with the exception of the 1950s cohort difference from 1940s.    

<br>

#### Sensitivity Tests

In addition to the main analysis, we conducted several sensitivity tests, the results of which are reported in the Appendix. First, we tested for any gender differences in cohort effects of mental health (Figure A1). The results are very similar to those reported for the full sample in Figure 1. The intercepts for men and women are different, with men’s average mental health being better than women’s average mental health. However, men and women have similar mental health trajectory differences between cohorts. Second, in 2011 the HILDA Survey added a top-up sample of new respondents. This was also around the same time that we start observing declines in mental health (see Figure 1, left panel). To ensure that the declining mental health trajectories are not driven by some unobserved characteristics of the respondents in the top-up sample, we also conducted the analyses excluding top-sample members. The results, shown in Figure A2, are similar to those in Figure 1 (right panel) and do not change the cohort trajectories. Third, instead of the MHI-5, we also applied the Kessler-10 (K10) psychological distress scale. K10 scores were collected in the HILDA Survey in alternate years from 2007 to 2019. The corresponding psychological distress trajectories for each cohort are shown in Figure A3, with higher K10 scores suggesting greater psychological distress. The trajectory patterns are consistent with those observed for the MHI-5 scale in Figure 1 (right panel), as psychological distress was higher for younger cohorts than older cohorts at the same age.

<br><br>

## Discussion

Population levels of mental health in Australia have been declining over the past decade or so. This is especially the case for younger adults aged between 15 and 35. Although there has been consistent debate about the possible drivers of these declining mental health trajectories (Skinner et al., 2022), little work has been done to try and identify more precisely the source of these patterns. Moreover, because of the concurrent presence of both and age- and period- effects, correctly disentangling such effects from any cohort effects are crucial if we are to identify the groups most at risk, and hence most in need of assistance.

Using 20 years of longitudinal data, we find that the observed deterioration in mental health in Australia is most consistent with a cohort effect. Importantly, it is the youngest cohorts and especially 1990s birth cohort that is experiencing a decreasing trajectory of mental health over time. Individuals in this cohort report worse mental health than older cohorts at the same ages, and can expect this difference to increase. Thus, the deterioration in mental health over time which has been reported in large cross-sectional surveys, is likely due to cohort-specific effects, related to the experience of young people born in the Millenial generation. These findings are similar for men and women, and the results are robust to alternative samples and measures used.

In comparison to other research on age effects in large population-based surveys, there are few examples examining mental health but many have focused on subjective wellbeing evaluated by a single item life-satisfaction question, also known as *cognitive* wellbeing, *evaluative* wellbeing or "happiness". There it has been pointed out that almost every plausible pattern of age-happiness trajectory has been reported in the literature, and further shown the pattern observed depends on the model adopted for analysis. For instance a U-shaped effect of age can be produced by a random intercept model which yields biased age effects due to endogenous selection of happier people with age [@kratz2021age]. We also controlled for such endogenous effects by mean centering MHI-5 scores within-person [and including the mean score as a predictor, @ligthart2016comparison], and still observed a fairly U-shaped pattern in age effects (Figure 2, right panel, dotted line). However the MHI-5 measures a distinct construct from life-satisfaction (aka "happiness"), and so represents a distinct psychological construct [@diener2017findings]; for instance it has a different time-course in responses to major life events [@kettlewell2020differential]. It is worth noting that when we examined age-effects on life-satisfaction, we did not observe cohort specific trajectories as we found with mental health.

We did not include major life events in our model because they can act as mediators that result from age and affect the response. We also did not include other potential mediators such as health status, relationship status, employment status, household income or region. As such our results should be considered estimates of the *total* effect of age on mental health, rather than any causal association, which is consistent with our aim to describe the age-related differences rather than explain them.

This study is intended as a starting point for more in-depth analysis or to invigorate other researchers to examine more closely the changes in mental health happening in Australia in the last decade. Understanding the exact causes of these patterns, in addition to appropriately targeted interventions, may be critical if the deteriorating pattern is to be arrested or shifted.

<br><br>

## Appendix

The difference between male and female MHI-5 trajectories is mostly in the intercept (overall mean level). Men and women have similar trajectory differences between cohorts.

##### Figure A1. Interaction between sex and cohort

```{r figure_A1, fig.dim=c(6, 6)}
reds <- RColorBrewer::brewer.pal(6, "Reds")

hilda.data %>%
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  ggplot(aes(x = age, y = ghmh)) +
    geom_smooth(aes(group = sex),
                method = "gam", formula = y ~ s(x, bs = "cs"),
                se=F, color = "black", size = .5, linetype = "dashed") +
    geom_smooth(aes(group = interaction(cohort,sex), 
                    color = interaction(cohort,sex)), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F) +
    labs(
      subtitle = "Smoothed MHI-5 scores (0-100)", 
      y = "", x = "\n Age (years)") +
    scale_color_manual(values = c(reds, blues9[3:9])) +
    guides() +
    theme_minimal() +
    theme(plot.title = element_text(face = "bold"),
          legend.title = element_text(size = 10),
          legend.position = c(0.85, 0.3),
          axis.title.x = element_text(size = 10))
```

<br>

Excluding the Wave 11 top-up sample does not appear to greatly impact the cohort trajectories.

##### Figure A2. Excluding top-up sample

```{r figure_A2, fig.dim=c(6,6)}
hilda.data %>%
  filter(!topup) %>%
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  ggplot(aes(x = age, y = ghmh)) +
    geom_smooth(aes(group = 1), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F, color = "black", size = .5, linetype = "dashed") +
    geom_smooth(aes(group = cohort, color = cohort), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F, alpha = 0.2) +
    labs(
      subtitle = "Smoothed MHI-5 scores (0-100)", 
      y = "", x = "\n Age (years)") +
    scale_color_manual(values = grey.colors(6, rev = T)) +
    theme_minimal() +
    theme(plot.title = element_text(face = "bold"),
          legend.title = element_text(size = 10),
          legend.position = c(0.9, 0.2),
          axis.title.x = element_text(size = 10))
```

<br>

K10 scores (psychological distress) were collected in alternate years from 2007 to 2019. The corresponding trajectories for each cohort are shown below. Psychological distress was higher for younger cohorts than older cohorts at the same age.

##### Figure A3. Psychological distress (K10 scores)

```{r figure_A3, warning=F, fig.dim=c(6,6)}
hilda.data %>%
  filter(!topup) %>%
  filter(cohort %in% c("1940s", "1950s", "1960s", "1970s", "1980s", "1990s")) %>%
  ggplot(aes(x = age, y = pdk10s)) +
    geom_smooth(aes(group = 1), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F, color = "black", size = .5, linetype = "dashed") +
    geom_smooth(aes(group = cohort, color = cohort), 
                method = "gam", formula = y ~ s(x, bs = "cs"), 
                se=F, alpha = 0.2) +
    labs(
      subtitle = "Smoothed K10 scores (10-50)", 
      y = "", x = "\n Age (years)") +
    scale_color_manual(values = grey.colors(6, rev = T)) +
    theme_minimal() +
    theme(plot.title = element_text(face = "bold"),
          legend.title = element_text(size = 10),
          legend.position = c(0.9, 0.82),
          axis.title.x = element_text(size = 10))
```

<br>

##### Figure A4. Correlated error structure

(not run)

```{r figure_A4, eval=F}
layout(matrix(5:1, ncol = 1))

read_rds("results/gam_90v80z.rds") %>% 
  .$lme %>%
  resid(type = "normalized") %>%
  pacf(lag.max = 12, main = "90sv80s")

read_rds("results/gam_80v70z.rds") %>% 
  .$lme %>%
  resid(type = "normalized") %>%
  pacf(lag.max = 12, main = "80sv70s")

read_rds("results/gam_70v60z.rds") %>% 
  .$lme %>%
  resid(type = "normalized") %>%
  pacf(lag.max = 12, main = "70sv60s")

read_rds("results/gam_60v50z.rds") %>% 
  .$lme %>%
  resid(type = "normalized") %>%
  pacf(lag.max = 12, main = "60sv50s")

read_rds("results/gam_50v40z.rds") %>% 
  .$lme %>%
  resid(type = "normalized") %>%
  pacf(lag.max = 12, main = "50sv40s")
```

<br><br>

## References
